{% extends 'user_temp/base.html' %} {% load static %} {% block extra_css %}
<style>
    /* ===== Hero Slider ===== */
    .hero-banner {
        width: 100%;
        max-height: 600px; /* chiều cao slider */
        overflow: hidden;
        position: relative;
        margin-top: 0;
        padding: 0;
    }

    .hero-banner img {
        width: 100%;
        height: 600px;
        object-fit: cover;
        display: none;
        transition: opacity 0.5s ease-in-out;
    }

    .hero-banner img.active {
        display: block;
    }

    /* Slider buttons */
    .prev,
    .next {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        padding: 15px;
        cursor: pointer;
        border-radius: 50%;
        font-size: 25px;
        z-index: 10;
    }

    /* Slider buttons modern style */
    .prev,
    .next {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: rgba(255, 255, 255, 0.7); /* nền trắng mờ */
        color: #223041; /* chữ xanh đậm */
        border: none;
        padding: 10px 14px; /* nhỏ hơn */
        cursor: pointer;
        border-radius: 50%; /* tròn hoàn toàn */
        font-size: 20px; /* chữ nhỏ vừa phải */
        z-index: 10;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); /* bóng mượt */
        transition: all 0.3s ease;
    }

    .prev:hover,
    .next:hover {
        background-color: #223041; /* nền xanh đậm khi hover */
        color: #fff; /* chữ trắng khi hover */
        transform: translateY(-50%) scale(1.1); /* nhấn nổi nhẹ */
    }

    .prev {
        left: 15px;
    }
    .next {
        right: 15px;
    }

    /* Slider dots */
    .slider-dots {
        position: absolute;
        bottom: 20px;
        width: 100%;
        text-align: center;
    }

    .slider-dots span {
        display: inline-block;
        width: 14px;
        height: 14px;
        margin: 0 5px;
        background-color: rgba(255, 255, 255, 0.6);
        border-radius: 50%;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .slider-dots span.active {
        background-color: white;
    }

    /* ===== Responsive ===== */
    @media (max-width: 991px) {
        .hero-banner img {
            height: 400px;
        }
    }

    @media (max-width: 576px) {
        .hero-banner img {
            height: 250px;
        }
    }

    /* ===== Category items ===== */
    .category-item img {
        width: 100%;
        height: 500px;
        object-fit: cover;
        border: 2px solid #ddd;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .category-item a:hover img {
        transform: scale(1.05);
    }

    /* ===== Product Section ===== */
    .product-card {
        border: 1px solid #ddd;
        border-radius: 5px;
        overflow: hidden;
        background: white;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .product-image {
        width: 100%;
        height: 250px;
        overflow: hidden;
    }

    .product-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .product-info {
        padding: 10px;
        display: flex;
        flex-direction: column;
        flex: 1;
    }

    .product-name {
        font-weight: bold;
        min-height: 40px;
        margin-bottom: 5px;
    }

    .product-price {
        color: #dc3545;
        margin-bottom: 10px;
    }

    .add-to-cart {
        margin-top: auto;
        width: 100%;
        background-color: #135fb1;
        color: white;
        padding: 10px 15px;
        text-decoration: none;
        font-weight: 500;
        display: block;
        text-align: center;
    }

    .add-to-cart:hover {
        background-color: #0d4a8a;
    }

    .view-more {
        border: 2px solid #135fb1;
        color: #135fb1;
        background-color: transparent;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
        display: inline-block;
        transition: all 0.3s ease;
    }

    .view-more:hover {
        background-color: #135fb1;
        color: white;
        text-decoration: none;
    }
</style>
{% endblock %} {% block content %}

<!-- Hero Slider -->
<div class="hero-banner slider" id="heroSlider">
    <img src="{% static 'images/banner 1.jpg' %}" alt="Library" class="active" />
    <img src="{% static 'images/van-hoc.jpg' %}" alt="Sách Văn Học" />
    <img src="{% static 'images/giao-trinh.jpg' %}" alt="Sách Giáo Trình" />
    <img src="{% static 'images/ky-nang-song.jpg' %}" alt="Kỹ năng sống" />

    <button class="prev">&#10094;</button>
    <button class="next">&#10095;</button>

    <div class="slider-dots" id="heroDots"></div>
</div>

<!-- Bộ sưu tập -->
<div class="container my-5">
    <h2 class="text-center mb-4">BỘ SƯU TẬP</h2>
    <div class="row text-center">
        {% for category in categories %}
        <div class="col-md-4 category-item">
            <a href="{% url 'category_detail' category.category_name %}" class="category-link">
                {% if category.category_name == "Sách Văn Học" %}
                <img src="{% static 'images/van-hoc.jpg' %}" alt="Sách Văn Học" />
                {% elif category.category_name == "Sách Giáo Trình" %}
                <img src="{% static 'images/giao-trinh.jpg' %}" alt="Sách Giáo Trình" />
                {% elif category.category_name == "Kỹ năng sống" %}
                <img src="{% static 'images/ky-nang-song.jpg' %}" alt="Kỹ năng sống" />
                {% else %}
                <img src="{% static 'images/default.jpg' %}" alt="{{ category.category_name }}" />
                {% endif %}
                <p class="mt-2">{{ category.category_name|upper }}</p>
            </a>
        </div>
        {% empty %}
        <div class="col-12">
            <p class="text-center">Chưa có danh mục nào</p>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Product Sections -->
{% for item in categories_with_products %}
<div class="container my-5 product-section {% if forloop.first %}mb-auto{% endif %}">
    <h2 class="text-center product-title">{{ item.category.category_name|upper }}</h2>

    <div class="row">
        {% for product in item.products %}
        <div class="col-6 col-md-3 text-center mb-4">
            <div class="product-card">
                <div class="product-image">
                    {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.product_name }}" />
                    {% else %}
                    <img src="/static/images/no-image.png" alt="No image" />
                    {% endif %}
                </div>

                <a href="{% url 'add_to_cart' product.id %}" class="add-to-cart"
                    >Thêm vào giỏ hàng</a
                >

                <div class="product-info">
                    <a
                        href="{% url 'product_detail_user' product.id %}"
                        style="text-decoration: none; color: inherit"
                    >
                        <p class="product-name">{{ product.product_name }}</p>
                    </a>
                    <p class="product-price">{{ product.sell_price|floatformat:0 }} VND</p>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <p class="text-center">Chưa có sản phẩm nào trong danh mục này</p>
        </div>
        {% endfor %}
    </div>

    <div class="text-center mb-4">
        <a
            href="{% url 'category_detail' item.category.category_name %}"
            class="btn btn-outline-dark view-more"
        >
            Xem thêm các ấn bản {{ item.category.category_name|upper }}
        </a>
    </div>
</div>
{% endfor %}

<script>
    // ===== Hero Slider Function =====
    document.addEventListener('DOMContentLoaded', function () {
        const slider = document.getElementById('heroSlider');
        const slides = slider.querySelectorAll('img');
        const prev = slider.querySelector('.prev');
        const next = slider.querySelector('.next');
        const dotsContainer = document.getElementById('heroDots');
        let current = 0;

        // Create dots
        slides.forEach((slide, index) => {
            const dot = document.createElement('span');
            dot.addEventListener('click', () => showSlide(index));
            dotsContainer.appendChild(dot);
        });
        const dots = dotsContainer.querySelectorAll('span');

        function showSlide(index) {
            slides[current].classList.remove('active');
            dots[current].classList.remove('active');
            current = (index + slides.length) % slides.length;
            slides[current].classList.add('active');
            dots[current].classList.add('active');
        }

        prev.addEventListener('click', () => showSlide(current - 1));
        next.addEventListener('click', () => showSlide(current + 1));

        function autoSlide() {
            showSlide(current + 1);
        }
        setInterval(autoSlide, 4000);

        showSlide(0);

        // Format prices
        const priceElements = document.querySelectorAll('.product-price');
        priceElements.forEach(function (element) {
            const text = element.textContent.trim();
            const match = text.match(/(\d+)\s*VND/);
            if (match) {
                const number = parseInt(match[1]);
                element.textContent = number.toLocaleString('vi-VN') + ' VND';
            }
        });
    });
</script>

{% endblock %}
