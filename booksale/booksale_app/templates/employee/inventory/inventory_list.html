{% extends 'employee/employee_base.html' %}
{% block content %}
<div class="p-8">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6 bg-blue-50 p-4 rounded-xl shadow-sm border border-blue-100">
    <h1 class="text-2xl font-semibold text-gray-800">
      üè∑Ô∏è Qu·∫£n l√Ω kho: <span class="text-gray-600">C·ª≠a h√†ng ch√≠nh</span>
    </h1>
  </div>

  <!-- Tabs -->
  <div class="flex border-b mb-6">
    <a href="?tab=all{% if search_query %}&search={{ search_query|urlencode }}{% endif %}"
       class="px-4 py-2 {% if active_tab == 'all' %}text-blue-600 border-b-2 border-blue-600 font-medium{% else %}text-gray-600 hover:text-blue-600{% endif %}">
       T·∫•t c·∫£
    </a>
    <a href="?tab=in{% if search_query %}&search={{ search_query|urlencode }}{% endif %}"
       class="px-4 py-2 {% if active_tab == 'in' %}text-blue-600 border-b-2 border-blue-600 font-medium{% else %}text-gray-600 hover:text-blue-600{% endif %}">
       C√≤n h√†ng
    </a>
    <a href="?tab=out{% if search_query %}&search={{ search_query|urlencode }}{% endif %}"
       class="px-4 py-2 {% if active_tab == 'out' %}text-blue-600 border-b-2 border-blue-600 font-medium{% else %}text-gray-600 hover:text-blue-600{% endif %}">
       H·∫øt h√†ng
    </a>
  </div>

  <!-- Search -->
  <div class="flex justify-between mb-4">
    <form method="get"
          class="flex items-center border border-blue-200 rounded-lg w-1/3 bg-white shadow-sm hover:shadow-md transition">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-3 text-blue-400" fill="none"
           viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"/>
      </svg>
      <input type="hidden" name="tab" value="{{ active_tab }}">
      <input type="text" name="search" value="{{ search_query|default:'' }}"
             placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m"
             class="w-full px-3 py-2 border-0 focus:ring-0 bg-transparent"
             autocomplete="off">
    </form>
  </div>

  <!-- Table -->
  <div class="bg-white shadow-md rounded-xl overflow-hidden border border-blue-100">
    <table class="min-w-full text-sm text-left text-gray-700">
      <thead class="bg-gray-50 text-gray-600 uppercase text-xs">
        <tr>
          <th class="px-4 py-3">ID</th>
          <th class="px-4 py-3">T√™n s·∫£n ph·∫©m</th>
          <th class="px-4 py-3 text-center">T·ªïng nh·∫≠p kho</th>
          <th class="px-4 py-3 text-center">T·ªïng ƒë√£ b√°n</th>
          <th class="px-4 py-3 text-center">T·ªìn kho</th>
          <th class="px-4 py-3 text-center">Tr·∫°ng th√°i</th>
          <th class="px-4 py-3 text-right">Gi√° b√°n</th>
          <th class="px-4 py-3 text-right">Gi√° v·ªën</th>
        </tr>
      </thead>
      <tbody>
        {% for item in inventory %}
        <tr class="border-b hover:bg-blue-50 transition">
          <td class="px-4 py-3">{{ item.product_code }}</td>
          <td class="px-4 py-3">{{ item.product_name }}</td>
          <td class="px-4 py-3 text-center">{{ item.total_imported }}</td>
          <td class="px-4 py-3 text-center">{{ item.total_sold }}</td>
          <td class="px-4 py-3 text-center">{{ item.quantity }}</td>
          <td class="px-4 py-3 text-center">
            {% if item.stock < 2 %}
              <span class="text-red-500 font-semibold">S·∫Øp h·∫øt</span>
            {% else %}
              <span class="text-green-500 font-semibold">ƒê·ªß h√†ng</span>
            {% endif %}
          </td>
          <td class="px-4 py-3 text-right">{{ item.sell_price }}ƒë</td>
          <td class="px-4 py-3 text-right">{{ item.cost_price }}ƒë</td>
        </tr>
        {% empty %}
        <tr><td colspan="8" class="px-4 py-6 text-center text-gray-400">Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- T·ª± ƒë·ªông t√¨m sau 0.4s khi g√µ -->
<script>
const box = document.querySelector('input[name="search"]');
const form = box.closest('form');
let timer;
box.addEventListener('input', () => {
  clearTimeout(timer);
  timer = setTimeout(() => form.submit(), 400);
});
</script>
{% endblock %}